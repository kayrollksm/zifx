<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZIFX â€” Payment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>body{font-family:Poppins,sans-serif}</style>
</head>

<body class="bg-[#0D1A1E] text-white">

<div id="sidebar"></div>

<main class="ml-64 min-h-screen flex items-center justify-center p-6">

  <div class="w-full max-w-md border border-white/10 rounded-xl p-6 bg-[#0F1F26]">
    <h2 class="text-lg font-semibold mb-4">Payment Confirmation</h2>

    <div class="space-y-3 mb-6">
      <div>
        <p class="text-sm text-[#7D8895]">Deposit Amount</p>
        <p id="amount" class="text-xl font-bold">RM 0</p>
      </div>

      <div class="text-sm text-[#7D8895]">
        <p>Bank: <span class="text-white">ZIFX HOLDING (Prototype)</span></p>
        <p>Account: <span class="text-white">123-456-789</span></p>
        <p>Reference: <span class="text-white">ZIFX-DEPOSIT</span></p>
      </div>
    </div>

    <button id="confirmBtn"
      class="w-full bg-[#00A7A6] py-3 rounded font-semibold text-[#0D1A1E]">
      I Have Made Payment
    </button>

    <p class="text-xs text-center text-[#7D8895] mt-4">
      Prototype only. No real bank transfer required.
    </p>
  </div>

</main>

<script>
/* LOAD SIDEBAR */
fetch("partials/sidebar.html")
  .then(r=>r.text())
  .then(h=>sidebar.innerHTML=h);

/* AUTH */
const currentUser = JSON.parse(localStorage.getItem("currentUser"));
if (!currentUser) location.href = "../login.html";

/* GET TX ID */
const params = new URLSearchParams(window.location.search);
const txId = params.get("tx");

if (!txId) {
  alert("Invalid payment session");
  location.href = "transactions.html";
}

/* LOAD TRANSACTIONS */
const txs = JSON.parse(localStorage.getItem("zifx_transactions")) || [];
const tx = txs.find(t => t.id === txId && t.status === "pending");

if (!tx) {
  alert("No pending payment found");
  location.href = "transactions.html";
}

/* DISPLAY */
document.getElementById("amount").innerText =
  "RM " + tx.amount.toLocaleString();

/* CONFIRM */
document.getElementById("confirmBtn").onclick = () => {
  alert("Payment submitted. Waiting admin approval.");
  location.href = "transactions.html";
};
</script>

</body>
</html>
